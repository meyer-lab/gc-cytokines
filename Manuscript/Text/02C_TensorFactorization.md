## Tensor Factorization Maps the Gamma Chain Family Response Space

![**Tensor factorization to map model-predicted cytokine responses.** A) Measured receptor abundance for ten PBMC-derived subpopulations gathered from a single donor. Points and error bars show geometric mean and standard deviation respectively (N = 4). Error bars for some points are too small to display. B-C) PCA scores (B) and loadings (C) of receptor abundance. Axis label percentages indicate percent variance explained. D) Schematic representation of CP decomposition. Model predictions are arranged in a cube depending upon the time, ligand treatment, and cell type being modeled. CP decomposition then helps to visualize this space. E) Percent variance reconstructed (R2X) versus the number of components used in non-negative CP decomposition. F-I) Component values versus time (F), cell type (G-H), or ligand stimulation (I). The variation explained by each component is the product of the component's time, ligand, and cell type factorization. Ligand components with only negligible values (< 15% max) are not shown.](./Manuscript/Figures/figure3.svg){#fig:tfac}

Even with an accurate model, exploring how dynamic responses vary across responding cell types and ligand treatments remains challenging. Restricting ones' view to a single time point, cell type, or ligand concentration provides only a slice of the picture. Therefore, we sought to apply factorization as a means to globally visualize ligand response.

As response to ligand is mostly defined by receptor expression, we quantitatively profiled the abundance of each IL-2, IL-15, and IL-7 receptor across ten PBMC subpopulations ([@Fig:tfac]A). PBMCs gathered from a single donor were stained using receptor-specific fluorescent antibodies and analyzed by flow cytometry; their subpopulations were separated using canonical markers ([@Fig:gating], tbl. S1). These data recapitulated known variation in these receptors, including high IL-7Rα or IL-2Rα expression in helper and regulatory T cells, respectively [@hassan19987; @Rochman_2009]. As mentioned above, IL-7 is uniquely able to cross-inhibit other γ~c~ cytokines, and excess IL-7Rα likely helps to ensure this occurs ([@Fig:cytokInt]C) [@Gonnordeaal1253]. Principal component analysis (PCA) helped visualize variation in this receptor abundance data. The ten PBMC cell types were mapped in a scores plot using two principal components, each of which was defined by a linear combination of the cell's receptor expression abundances as described in our loadings plot ([@Fig:tfac]B-C). Principal component 1, which explained 50% of the receptor expression data's variance, most prominently separated the NK cells from all others due to their distinct receptor expression featuring high levels of IL-2Rβ and relatively lower levels of γ~c~, which are strongly positively and negatively correlated with principal component 1 respectively. Principal component 2, which explained 36% of the receptor expression data's variance, then separated effector and regulatory T cell populations, based on their high IL-7Rα or IL-2Rα abundance, respectively. However, PCA also helped to identify slightly higher γ~c~ levels in T~reg~s, and the slightly more T~reg~-like profile of memory CD8+ cells.

To build a tensor of model predictions, we assembled simulation predictions across cell types, ligand conditions, and time. This three-dimensional (time, cell type, ligand) tensor was then decomposed with non-negative canonical polyadic (CP) decomposition ([@Fig:tfac]D). We selected three components during decomposition as this number captured 95% of the variance in our original data tensor ([@Fig:tfac]E). To show the relationships among the tensor's three dimensions, the component plots of each dimension were plotted alongside each other.

CP decomposition can be interpreted by matching a single component's effects across factor plots for each dimension, allowing us to interperet its relationship to time, which cell's response it is most strongly correlated to. and at which stimulation concentration it explains the most variance in the data ([@Fig:tfac]F–I). For example, component 2 is greatest at roughly 50 mins, for helper and CD8+ T cells, and almost exclusively with IL-7 stimulation ([@Fig:tfac]F–I). This indicates that this variation in the data occurs with IL-7 stimulation, leads to a response in helper and CD8+ T cells, and peaks at 50 mins. In this way, different contributory factors in cell response are separated.

All components showed similar variation with time, peaking quickly and then decreasing after roughly 50 mins ([@Fig:tfac]F). This can be understood through two phases, in which receptor activation occurs, and then trafficking-mediated downregulation of the receptors ([@Fig:modelConstruct]). Comparing the cells and ligands decomposition plots showed expected effects. IL-7 response was separated by component 2, which showed a dose-dependent increase, and correlated with IL-7Rα expression levels ([@Fig:tfac]A/G/I). Interestingly, IL-2/-15 response separated by concentration, rather than ligand ([@Fig:tfac]I). Low concentrations of IL-2 were represented by component 3, and preferentially activated regulatory over effector T cells ([@Fig:tfac]H/I). High concentrations of IL-2/-15 were represented by component 1 and similarly activated effector and regulatory T cells ([@Fig:tfac]G/I). This known dichotomy occurs through higher IL-2Rα expression in T~reg~s ([@Fig:tfac]A). Importantly, while PCA can help to distinguish cells based on distinct receptor expression profiles, cells separated differently based on their predicted ligand stimulation response ([@Fig:tfac]B/G/H). This demonstrates the unique benefit of tensor- and model-based factorization to distinguish cells based upon their predicted response profiles.

Other tensor decomposition methods exist and can also be applied to visualize model-predicted response. For example, non-negative Tucker decomposition relaxes CP decomposition by employing a core tensor enabling interaction terms between components ([@Fig:supp4]) [@Tucker1966]. However, this flexibility comes at the cost of interpretability, as visualizing the core tensor's effect is challenging. In total, factorization methods provide an effective means of visualizing the high-dimensional regulation of complex receptor families, including the influence of time, ligand stimulation, and receptor expression.
